---
title: "Activity Data Review"
author: "Russell Husfeld"
date: "May 24, 2016"
output: html_document
---

Loading and preprocessing the data

Show any code that is needed to

Load the data (i.e. read.csv())

Process/transform the data (if necessary) into a format suitable for your analysis


```{r}
activity <- read.csv("~/Documents/activity.csv")
str(activity)
#convert the date into Date formate "Y-m-d"
activity$date <- as.Date(activity$date,"%Y-%m-%d")
#check to make sure integer to date class has changed. 
str(activity)
activity$steps <- as.numeric(activity$steps)
library(dplyr)

```
Date is now processed for work in the next steps. 

Next steps are 
What is mean total number of steps taken per day?
```{r}
activity.date<- activity %>%
  group_by(date) %>%
  summarize(tsteps=sum(steps, na.rm=TRUE))
library(lattice)

histogram(~activity.date$tstep, xlab="Total Steps")

meansteps<- mean(activity.date$tsteps)
mediansteps<- median(activity.date$tsteps)

```

The mean steps are 'meansteps' and median is 'mediansteps'. 


For this part of the assignment, you can ignore the missing values in the dataset.
Make a histogram of the total number of steps taken each day
Calculate and report the mean and median total number of steps taken per day
```{r}
activityint<- activity %>%
  group_by(interval) %>%
  summarize(tsteps=sum(steps, na.rm=TRUE), avgsteps=mean(steps, na.rm=TRUE)) 

with(activityint, xyplot(avgsteps~interval, type="l", xlab="5-minute Time Interval", ylab="Average Number of Steps Taken per Interval"))

maxint<- which.max(activityint$tsteps)
activityint[maxint, ]

missing.values<- sum(is.na(activity$steps))
missing.values


activity.replaceNA<- activity %>%
  group_by(interval)  %>%
  mutate(steps= ifelse(is.na(steps), mean(steps, na.rm=TRUE), steps))

histogram(activity.date$tsteps, xlab="Total Steps")

```





```{r}
library(lubridate)
activity.replaceNA$day<- wday(activity.replaceNA$date, label=TRUE)
activity.replaceNA$daytype<- activity.replaceNA$day
levels(activity.replaceNA$daytype) <- list(
    weekday = c("Mon", "Tues", "Wed", "Thurs", "Fri"),
    weekend = c("Sun", "Sat"))

activity.typeday<- activity.replaceNA %>%
  group_by(daytype, interval)  %>% 
  summarize(total.steps=sum(steps, na.rm=TRUE), average.steps=mean(steps, na.rm=TRUE))

xyplot(average.steps~interval|daytype, data=activity.typeday, type='l', layout=(c(1,2)),
      ylab="Average Number of Steps Taken per Interval", xlab="5-minute Time Interval")  


```